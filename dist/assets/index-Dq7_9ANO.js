(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const s of l.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(i){if(i.ep)return;i.ep=!0;const l=n(i);fetch(i.href,l)}})();const xn=!1;var yt=Array.isArray,vr=Array.prototype.indexOf,Ut=Array.from,at=Object.defineProperty,Ke=Object.getOwnPropertyDescriptor,kn=Object.getOwnPropertyDescriptors,hr=Object.prototype,pr=Array.prototype,Ht=Object.getPrototypeOf,nn=Object.isExtensible;const Ne=()=>{};function _r(e){return e()}function ut(e){for(var t=0;t<e.length;t++)e[t]()}function gr(){var e,t,n=new Promise((r,i)=>{e=r,t=i});return{promise:n,resolve:e,reject:t}}const Y=2,zt=4,mt=8,Ue=16,ce=32,Te=64,En=128,Q=256,ft=512,F=1024,J=2048,we=4096,ee=8192,He=16384,jt=32768,Bt=65536,rn=1<<17,wr=1<<18,tt=1<<19,Sn=1<<20,Nt=1<<21,Wt=1<<22,ke=1<<23,he=Symbol("$state"),yr=Symbol(""),Kt=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function mr(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function Pn(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function br(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function xr(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function kr(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Er(e){throw new Error("https://svelte.dev/e/effect_orphan")}function Sr(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Pr(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Cr(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Tr(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const $r=1,Ar=2,Mr=16,Rr=1,Or=2,D=Symbol(),Nr="http://www.w3.org/1999/xhtml";function Ir(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let Dr=!1;function Cn(e){return e===this.v}function Tn(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function $n(e){return!Tn(e,this.v)}let nt=!1,Lr=!1;function qr(){nt=!0}let N=null;function ct(e){N=e}function ye(e,t=!1,n){N={p:N,c:null,e:null,s:e,x:null,l:nt&&!t?{s:null,u:null,$:[]}:null}}function me(e){var t=N,n=t.e;if(n!==null){t.e=null;for(var r of n)Kn(r)}return N=t.p,{}}function rt(){return!nt||N!==null&&N.l===null}const Fr=new WeakMap;function Ur(e){var t=k;if(t===null)return x.f|=ke,e;if((t.f&jt)===0){if((t.f&En)===0)throw!t.parent&&e instanceof Error&&An(e),e;t.b.error(e)}else Vt(e,t)}function Vt(e,t){for(;t!==null;){if((t.f&En)!==0)try{t.b.error(e);return}catch(n){e=n}t=t.parent}throw e instanceof Error&&An(e),e}function An(e){const t=Fr.get(e);t&&(at(e,"message",{value:t.message}),at(e,"stack",{value:t.stack}))}let Xe=[],It=[];function Mn(){var e=Xe;Xe=[],ut(e)}function Hr(){var e=It;It=[],ut(e)}function Rn(e){Xe.length===0&&queueMicrotask(Mn),Xe.push(e)}function zr(){Xe.length>0&&Mn(),It.length>0&&Hr()}function jr(){for(var e=k.b;e!==null&&!e.has_pending_snippet();)e=e.parent;return e===null&&mr(),e}function Gt(e){var t=Y|J,n=x!==null&&(x.f&Y)!==0?x:null;return k===null||n!==null&&(n.f&Q)!==0?t|=Q:k.f|=tt,{ctx:N,deps:null,effects:null,equals:Cn,f:t,fn:e,reactions:null,rv:0,v:D,wv:0,parent:n??k,ac:null}}function Br(e,t){let n=k;n===null&&br();var r=n.b,i=void 0,l=Ze(D),s=null,a=!x;return ri(()=>{try{var o=e();s&&Promise.resolve(o).catch(()=>{})}catch(v){o=Promise.reject(v)}var u=()=>o;i=s?.then(u,u)??Promise.resolve(o),s=i;var f=A,d=r.pending;a&&(r.update_pending_count(1),d||f.increment());const c=(v,h=void 0)=>{s=null,d||f.activate(),h?h!==Kt&&(l.f|=ke,Qe(l,h)):((l.f&ke)!==0&&(l.f^=ke),Qe(l,v)),a&&(r.update_pending_count(-1),d||f.decrement()),Dn()};if(i.then(c,v=>c(null,v||"unknown")),f)return()=>{queueMicrotask(()=>f.neuter())}}),new Promise(o=>{function u(f){function d(){f===i?o(l):u(i)}f.then(d,d)}u(i)})}function On(e){const t=Gt(e);return t.equals=$n,t}function Nn(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)fe(t[n])}}function Wr(e){for(var t=e.parent;t!==null;){if((t.f&Y)===0)return t;t=t.parent}return null}function Yt(e){var t,n=k;ge(Wr(e));try{Nn(e),t=ir(e)}finally{ge(n)}return t}function In(e){var t=Yt(e);if(e.equals(t)||(e.v=t,e.wv=nr()),!ze){var n=(ve||(e.f&Q)!==0)&&e.deps!==null?we:F;K(e,n)}}function Kr(e,t,n){const r=rt()?Gt:On;if(t.length===0){n(e.map(r));return}var i=A,l=k,s=Vr(),a=jr();Promise.all(t.map(o=>Br(o))).then(o=>{i?.activate(),s();try{n([...e.map(r),...o])}catch(u){(l.f&He)===0&&Vt(u,l)}i?.deactivate(),Dn()}).catch(o=>{a.error(o)})}function Vr(){var e=k,t=x,n=N,r=A;return function(){ge(e),re(t),ct(n),r?.activate()}}function Dn(){ge(null),re(null),ct(null)}const $t=new Set;let A=null,st=null,ln=new Set,dt=[];function Ln(){const e=dt.shift();dt.length>0&&queueMicrotask(Ln),e()}let Se=[],bt=null,Dt=!1,ot=!1;class Le{current=new Map;#a=new Map;#i=new Set;#e=0;#u=null;#f=!1;#n=[];#l=[];#r=[];#t=[];#s=[];#c=[];#d=[];skipped_effects=new Set;process(t){Se=[],st=null;for(const i of t)this.#h(i);if(this.#n.length===0&&this.#e===0){this.#v();var n=this.#r,r=this.#t;this.#r=[],this.#t=[],this.#s=[],st=A,A=null,sn(n),sn(r),A===null?A=this:$t.delete(this),this.#u?.resolve()}else this.#o(this.#r),this.#o(this.#t),this.#o(this.#s);for(const i of this.#n)De(i);for(const i of this.#l)De(i);this.#n=[],this.#l=[]}#h(t){t.f^=F;for(var n=t.first;n!==null;){var r=n.f,i=(r&(ce|Te))!==0,l=i&&(r&F)!==0,s=l||(r&ee)!==0||this.skipped_effects.has(n);if(!s&&n.fn!==null){if(i)n.f^=F;else if((r&zt)!==0)this.#t.push(n);else if((r&F)===0)if((r&Wt)!==0){var a=n.b?.pending?this.#l:this.#n;a.push(n)}else St(n)&&((n.f&Ue)!==0&&this.#s.push(n),De(n));var o=n.first;if(o!==null){n=o;continue}}var u=n.parent;for(n=n.next;n===null&&u!==null;)n=u.next,u=u.parent}}#o(t){for(const n of t)((n.f&J)!==0?this.#c:this.#d).push(n),K(n,F);t.length=0}capture(t,n){this.#a.has(t)||this.#a.set(t,n),this.current.set(t,t.v)}activate(){A=this}deactivate(){A=null,st=null;for(const t of ln)if(ln.delete(t),t(),A!==null)break}neuter(){this.#f=!0}flush(){Se.length>0?qn():this.#v(),A===this&&(this.#e===0&&$t.delete(this),this.deactivate())}#v(){if(!this.#f)for(const t of this.#i)t();this.#i.clear()}increment(){this.#e+=1}decrement(){if(this.#e-=1,this.#e===0){for(const t of this.#c)K(t,J),qe(t);for(const t of this.#d)K(t,we),qe(t);this.#r=[],this.#t=[],this.flush()}else this.deactivate()}add_callback(t){this.#i.add(t)}settled(){return(this.#u??=gr()).promise}static ensure(){if(A===null){const t=A=new Le;$t.add(A),ot||Le.enqueue(()=>{A===t&&t.flush()})}return A}static enqueue(t){dt.length===0&&queueMicrotask(Ln),dt.unshift(t)}}function Gr(e){var t=ot;ot=!0;try{for(var n;;){if(zr(),Se.length===0&&(A?.flush(),Se.length===0))return bt=null,n;qn()}}finally{ot=t}}function qn(){var e=Ie;Dt=!0;try{var t=0;for(fn(!0);Se.length>0;){var n=Le.ensure();if(t++>1e3){var r,i;Yr()}n.process(Se),pe.clear()}}finally{Dt=!1,fn(e),bt=null}}function Yr(){try{Sr()}catch(e){Vt(e,bt)}}let be=null;function sn(e){var t=e.length;if(t!==0){for(var n=0;n<t;){var r=e[n++];if((r.f&(He|ee))===0&&St(r)&&(be=[],De(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?Qn(r):r.fn=null),be?.length>0)){pe.clear();for(const i of be)De(i);be=[]}}be=null}}function qe(e){for(var t=bt=e;t.parent!==null;){t=t.parent;var n=t.f;if(Dt&&t===k&&(n&Ue)!==0)return;if((n&(Te|ce))!==0){if((n&F)===0)return;t.f^=F}}Se.push(t)}const pe=new Map;function Ze(e,t){var n={f:0,v:e,reactions:null,equals:Cn,rv:0,wv:0};return n}function de(e,t){const n=Ze(e);return ai(n),n}function Pe(e,t=!1,n=!0){const r=Ze(e);return t||(r.equals=$n),nt&&n&&N!==null&&N.l!==null&&(N.l.s??=[]).push(r),r}function H(e,t,n=!1){x!==null&&(!ne||(x.f&rn)!==0)&&rt()&&(x.f&(Y|Ue|Wt|rn))!==0&&!ue?.includes(e)&&Tr();let r=n?Be(t):t;return Qe(e,r)}function Qe(e,t){if(!e.equals(t)){var n=e.v;ze?pe.set(e,t):pe.set(e,n),e.v=t;var r=Le.ensure();r.capture(e,n),(e.f&Y)!==0&&((e.f&J)!==0&&Yt(e),K(e,(e.f&Q)===0?F:we)),e.wv=nr(),Fn(e,J),rt()&&k!==null&&(k.f&F)!==0&&(k.f&(ce|Te))===0&&(Z===null?ui([e]):Z.push(e))}return t}function At(e){H(e,e.v+1)}function Fn(e,t){var n=e.reactions;if(n!==null)for(var r=rt(),i=n.length,l=0;l<i;l++){var s=n[l],a=s.f;if(!(!r&&s===k)){var o=(a&J)===0;o&&K(s,t),(a&Y)!==0?Fn(s,we):o&&((a&Ue)!==0&&be!==null&&be.push(s),qe(s))}}}function Be(e){if(typeof e!="object"||e===null||he in e)return e;const t=Ht(e);if(t!==hr&&t!==pr)return e;var n=new Map,r=yt(e),i=de(0),l=Ee,s=a=>{if(Ee===l)return a();var o=x,u=Ee;re(null),dn(l);var f=a();return re(o),dn(u),f};return r&&n.set("length",de(e.length)),new Proxy(e,{defineProperty(a,o,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&Pr();var f=n.get(o);return f===void 0?f=s(()=>{var d=de(u.value);return n.set(o,d),d}):H(f,u.value,!0),!0},deleteProperty(a,o){var u=n.get(o);if(u===void 0){if(o in a){const f=s(()=>de(D));n.set(o,f),At(i)}}else H(u,D),At(i);return!0},get(a,o,u){if(o===he)return e;var f=n.get(o),d=o in a;if(f===void 0&&(!d||Ke(a,o)?.writable)&&(f=s(()=>{var v=Be(d?a[o]:D),h=de(v);return h}),n.set(o,f)),f!==void 0){var c=T(f);return c===D?void 0:c}return Reflect.get(a,o,u)},getOwnPropertyDescriptor(a,o){var u=Reflect.getOwnPropertyDescriptor(a,o);if(u&&"value"in u){var f=n.get(o);f&&(u.value=T(f))}else if(u===void 0){var d=n.get(o),c=d?.v;if(d!==void 0&&c!==D)return{enumerable:!0,configurable:!0,value:c,writable:!0}}return u},has(a,o){if(o===he)return!0;var u=n.get(o),f=u!==void 0&&u.v!==D||Reflect.has(a,o);if(u!==void 0||k!==null&&(!f||Ke(a,o)?.writable)){u===void 0&&(u=s(()=>{var c=f?Be(a[o]):D,v=de(c);return v}),n.set(o,u));var d=T(u);if(d===D)return!1}return f},set(a,o,u,f){var d=n.get(o),c=o in a;if(r&&o==="length")for(var v=u;v<d.v;v+=1){var h=n.get(v+"");h!==void 0?H(h,D):v in a&&(h=s(()=>de(D)),n.set(v+"",h))}if(d===void 0)(!c||Ke(a,o)?.writable)&&(d=s(()=>de(void 0)),H(d,Be(u)),n.set(o,d));else{c=d.v!==D;var _=s(()=>Be(u));H(d,_)}var y=Reflect.getOwnPropertyDescriptor(a,o);if(y?.set&&y.set.call(f,u),!c){if(r&&typeof o=="string"){var g=n.get("length"),p=Number(o);Number.isInteger(p)&&p>=g.v&&H(g,p+1)}At(i)}return!0},ownKeys(a){T(i);var o=Reflect.ownKeys(a).filter(d=>{var c=n.get(d);return c===void 0||c.v!==D});for(var[u,f]of n)f.v!==D&&!(u in a)&&o.push(u);return o},setPrototypeOf(){Cr()}})}function on(e){try{if(e!==null&&typeof e=="object"&&he in e)return e[he]}catch{}return e}function Xr(e,t){return Object.is(on(e),on(t))}var an,Un,Hn,zn;function Zr(){if(an===void 0){an=window,Un=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;Hn=Ke(t,"firstChild").get,zn=Ke(t,"nextSibling").get,nn(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),nn(n)&&(n.__t=void 0)}}function Xt(e=""){return document.createTextNode(e)}function vt(e){return Hn.call(e)}function xt(e){return zn.call(e)}function M(e,t){return vt(e)}function kt(e,t){{var n=vt(e);return n instanceof Comment&&n.data===""?xt(n):n}}function P(e,t=1,n=!1){let r=e;for(;t--;)r=xt(r);return r}function Qr(e){e.textContent=""}function jn(){return!1}let un=!1;function Jr(){un||(un=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function Et(e){var t=x,n=k;re(null),ge(null);try{return e()}finally{re(t),ge(n)}}function Bn(e,t,n,r=n){e.addEventListener(t,()=>Et(n));const i=e.__on_r;i?e.__on_r=()=>{i(),r(!0)}:e.__on_r=()=>r(!0),Jr()}function Wn(e){k===null&&x===null&&Er(),x!==null&&(x.f&Q)!==0&&k===null&&kr(),ze&&xr()}function ei(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function ie(e,t,n,r=!0){var i=k;i!==null&&(i.f&ee)!==0&&(e|=ee);var l={ctx:N,deps:null,nodes_start:null,nodes_end:null,f:e|J,first:null,fn:t,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{De(l),l.f|=jt}catch(o){throw fe(l),o}else t!==null&&qe(l);if(r){var s=l;if(n&&s.deps===null&&s.teardown===null&&s.nodes_start===null&&s.first===s.last&&(s.f&tt)===0&&(s=s.first),s!==null&&(s.parent=i,i!==null&&ei(s,i),x!==null&&(x.f&Y)!==0&&(e&Te)===0)){var a=x;(a.effects??=[]).push(s)}}return l}function Zt(e){const t=ie(mt,null,!1);return K(t,F),t.teardown=e,t}function Lt(e){Wn();var t=k.f,n=!x&&(t&ce)!==0&&(t&jt)===0;if(n){var r=N;(r.e??=[]).push(e)}else return Kn(e)}function Kn(e){return ie(zt|Sn,e,!1)}function ti(e){return Wn(),ie(mt|Sn,e,!0)}function ni(e){Le.ensure();const t=ie(Te|tt,e,!0);return(n={})=>new Promise(r=>{n.outro?Qt(t,()=>{fe(t),r(void 0)}):(fe(t),r(void 0))})}function Vn(e){return ie(zt,e,!1)}function ri(e){return ie(Wt|tt,e,!0)}function Gn(e,t=0){return ie(mt|t,e,!0)}function _e(e,t=[],n=[]){Kr(t,n,r=>{ie(mt,()=>e(...r.map(T)),!0)})}function Yn(e,t=0){var n=ie(Ue|t,e,!0);return n}function Je(e,t=!0){return ie(ce|tt,e,!0,t)}function Xn(e){var t=e.teardown;if(t!==null){const n=ze,r=x;cn(!0),re(null);try{t.call(null)}finally{cn(n),re(r)}}}function Zn(e,t=!1){var n=e.first;for(e.first=e.last=null;n!==null;){const i=n.ac;i!==null&&Et(()=>{i.abort(Kt)});var r=n.next;(n.f&Te)!==0?n.parent=null:fe(n,t),n=r}}function ii(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&ce)===0&&fe(t),t=n}}function fe(e,t=!0){var n=!1;(t||(e.f&wr)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(li(e.nodes_start,e.nodes_end),n=!0),Zn(e,t&&!n),ht(e,0),K(e,He);var r=e.transitions;if(r!==null)for(const l of r)l.stop();Xn(e);var i=e.parent;i!==null&&i.first!==null&&Qn(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function li(e,t){for(;e!==null;){var n=e===t?null:xt(e);e.remove(),e=n}}function Qn(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function Qt(e,t){var n=[];Jt(e,n,!0),Jn(n,()=>{fe(e),t&&t()})}function Jn(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var i of e)i.out(r)}else t()}function Jt(e,t,n){if((e.f&ee)===0){if(e.f^=ee,e.transitions!==null)for(const s of e.transitions)(s.is_global||n)&&t.push(s);for(var r=e.first;r!==null;){var i=r.next,l=(r.f&Bt)!==0||(r.f&ce)!==0;Jt(r,t,l?n:!1),r=i}}}function en(e){er(e,!0)}function er(e,t){if((e.f&ee)!==0){e.f^=ee,(e.f&F)===0&&(K(e,J),qe(e));for(var n=e.first;n!==null;){var r=n.next,i=(n.f&Bt)!==0||(n.f&ce)!==0;er(n,i?t:!1),n=r}if(e.transitions!==null)for(const l of e.transitions)(l.is_global||t)&&l.in()}}let Oe=null;function si(e){var t=Oe;try{if(Oe=new Set,O(e),t!==null)for(var n of Oe)t.add(n);return Oe}finally{Oe=t}}function oi(e){for(var t of si(e))Qe(t,t.v)}let Ie=!1;function fn(e){Ie=e}let ze=!1;function cn(e){ze=e}let x=null,ne=!1;function re(e){x=e}let k=null;function ge(e){k=e}let ue=null;function ai(e){x!==null&&(ue===null?ue=[e]:ue.push(e))}let U=null,G=0,Z=null;function ui(e){Z=e}let tr=1,et=0,Ee=et;function dn(e){Ee=e}let ve=!1;function nr(){return++tr}function St(e){var t=e.f;if((t&J)!==0)return!0;if((t&we)!==0){var n=e.deps,r=(t&Q)!==0;if(n!==null){var i,l,s=(t&ft)!==0,a=r&&k!==null&&!ve,o=n.length;if((s||a)&&(k===null||(k.f&He)===0)){var u=e,f=u.parent;for(i=0;i<o;i++)l=n[i],(s||!l?.reactions?.includes(u))&&(l.reactions??=[]).push(u);s&&(u.f^=ft),a&&f!==null&&(f.f&Q)===0&&(u.f^=Q)}for(i=0;i<o;i++)if(l=n[i],St(l)&&In(l),l.wv>e.wv)return!0}(!r||k!==null&&!ve)&&K(e,F)}return!1}function rr(e,t,n=!0){var r=e.reactions;if(r!==null&&!ue?.includes(e))for(var i=0;i<r.length;i++){var l=r[i];(l.f&Y)!==0?rr(l,t,!1):t===l&&(n?K(l,J):(l.f&F)!==0&&K(l,we),qe(l))}}function ir(e){var t=U,n=G,r=Z,i=x,l=ve,s=ue,a=N,o=ne,u=Ee,f=e.f;U=null,G=0,Z=null,ve=(f&Q)!==0&&(ne||!Ie||x===null),x=(f&(ce|Te))===0?e:null,ue=null,ct(e.ctx),ne=!1,Ee=++et,e.ac!==null&&(Et(()=>{e.ac.abort(Kt)}),e.ac=null);try{e.f|=Nt;var d=e.fn,c=d(),v=e.deps;if(U!==null){var h;if(ht(e,G),v!==null&&G>0)for(v.length=G+U.length,h=0;h<U.length;h++)v[G+h]=U[h];else e.deps=v=U;if(!ve||(f&Y)!==0&&e.reactions!==null)for(h=G;h<v.length;h++)(v[h].reactions??=[]).push(e)}else v!==null&&G<v.length&&(ht(e,G),v.length=G);if(rt()&&Z!==null&&!ne&&v!==null&&(e.f&(Y|we|J))===0)for(h=0;h<Z.length;h++)rr(Z[h],e);return i!==null&&i!==e&&(et++,Z!==null&&(r===null?r=Z:r.push(...Z))),(e.f&ke)!==0&&(e.f^=ke),c}catch(_){return Ur(_)}finally{e.f^=Nt,U=t,G=n,Z=r,x=i,ve=l,ue=s,ct(a),ne=o,Ee=u}}function fi(e,t){let n=t.reactions;if(n!==null){var r=vr.call(n,e);if(r!==-1){var i=n.length-1;i===0?n=t.reactions=null:(n[r]=n[i],n.pop())}}n===null&&(t.f&Y)!==0&&(U===null||!U.includes(t))&&(K(t,we),(t.f&(Q|ft))===0&&(t.f^=ft),Nn(t),ht(t,0))}function ht(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)fi(e,n[r])}function De(e){var t=e.f;if((t&He)===0){K(e,F);var n=k,r=Ie;k=e,Ie=!0;try{(t&Ue)!==0?ii(e):Zn(e),Xn(e);var i=ir(e);e.teardown=typeof i=="function"?i:null,e.wv=tr;var l;xn&&Lr&&(e.f&J)!==0&&e.deps}finally{Ie=r,k=n}}}async function ci(){await Promise.resolve(),Gr()}function T(e){var t=e.f,n=(t&Y)!==0;if(Oe?.add(e),x!==null&&!ne){var r=k!==null&&(k.f&He)!==0;if(!r&&!ue?.includes(e)){var i=x.deps;if((x.f&Nt)!==0)e.rv<et&&(e.rv=et,U===null&&i!==null&&i[G]===e?G++:U===null?U=[e]:(!ve||!U.includes(e))&&U.push(e));else{(x.deps??=[]).push(e);var l=e.reactions;l===null?e.reactions=[x]:l.includes(x)||l.push(x)}}}else if(n&&e.deps===null&&e.effects===null){var s=e,a=s.parent;a!==null&&(a.f&Q)===0&&(s.f^=Q)}if(ze){if(pe.has(e))return pe.get(e);if(n){s=e;var o=s.v;return((s.f&F)===0&&s.reactions!==null||lr(s))&&(o=Yt(s)),pe.set(s,o),o}}else n&&(s=e,St(s)&&In(s));if((e.f&ke)!==0)throw e.v;return e.v}function lr(e){if(e.v===D)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(pe.has(t)||(t.f&Y)!==0&&lr(t))return!0;return!1}function O(e){var t=ne;try{return ne=!0,e()}finally{ne=t}}const di=-7169;function K(e,t){e.f=e.f&di|t}function vi(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(he in e)qt(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];typeof n=="object"&&n&&he in n&&qt(n)}}}function qt(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let r in e)try{qt(e[r],t)}catch{}const n=Ht(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=kn(n);for(let i in r){const l=r[i].get;if(l)try{l.call(e)}catch{}}}}}const hi=["touchstart","touchmove"];function pi(e){return hi.includes(e)}const _i=new Set,vn=new Set;function gi(e,t,n,r={}){function i(l){if(r.capture||We.call(t,l),!l.cancelBubble)return Et(()=>n?.call(this,l))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Rn(()=>{t.addEventListener(e,i,r)}):t.addEventListener(e,i,r),i}function S(e,t,n,r,i){var l={capture:r,passive:i},s=gi(e,t,n,l);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&Zt(()=>{t.removeEventListener(e,s,l)})}let hn=null;function We(e){var t=this,n=t.ownerDocument,r=e.type,i=e.composedPath?.()||[],l=i[0]||e.target;hn=e;var s=0,a=hn===e&&e.__root;if(a){var o=i.indexOf(a);if(o!==-1&&(t===document||t===window)){e.__root=t;return}var u=i.indexOf(t);if(u===-1)return;o<=u&&(s=o)}if(l=i[s]||e.target,l!==t){at(e,"currentTarget",{configurable:!0,get(){return l||n}});var f=x,d=k;re(null),ge(null);try{for(var c,v=[];l!==null;){var h=l.assignedSlot||l.parentNode||l.host||null;try{var _=l["__"+r];if(_!=null&&(!l.disabled||e.target===l))if(yt(_)){var[y,...g]=_;y.apply(l,[e,...g])}else _.call(l,e)}catch(p){c?v.push(p):c=p}if(e.cancelBubble||h===t||h===null)break;l=h}if(c){for(let p of v)queueMicrotask(()=>{throw p});throw c}}finally{e.__root=t,delete e.currentTarget,re(f),ge(d)}}}function wi(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function pn(e,t){var n=k;n.nodes_start===null&&(n.nodes_start=e,n.nodes_end=t)}function j(e,t){var n=(t&Rr)!==0,r=(t&Or)!==0,i,l=!e.startsWith("<!>");return()=>{i===void 0&&(i=wi(l?e:"<!>"+e),n||(i=vt(i)));var s=r||Un?document.importNode(i,!0):i.cloneNode(!0);if(n){var a=vt(s),o=s.lastChild;pn(a,o)}else pn(s,s);return s}}function z(e,t){e!==null&&e.before(t)}function yi(e,t){return mi(e,t)}const Ae=new Map;function mi(e,{target:t,anchor:n,props:r={},events:i,context:l,intro:s=!0}){Zr();var a=new Set,o=d=>{for(var c=0;c<d.length;c++){var v=d[c];if(!a.has(v)){a.add(v);var h=pi(v);t.addEventListener(v,We,{passive:h});var _=Ae.get(v);_===void 0?(document.addEventListener(v,We,{passive:h}),Ae.set(v,1)):Ae.set(v,_+1)}}};o(Ut(_i)),vn.add(o);var u=void 0,f=ni(()=>{var d=n??t.appendChild(Xt());return Je(()=>{if(l){ye({});var c=N;c.c=l}i&&(r.$$events=i),u=e(d,r)||{},l&&me()}),()=>{for(var c of a){t.removeEventListener(c,We);var v=Ae.get(c);--v===0?(document.removeEventListener(c,We),Ae.delete(c)):Ae.set(c,v)}vn.delete(o),d!==n&&d.parentNode?.removeChild(d)}});return bi.set(u,f),u}let bi=new WeakMap;function pt(e,t,n=!1){var r=e,i=null,l=null,s=D,a=n?Bt:0,o=!1;const u=(v,h=!0)=>{o=!0,c(h,v)};var f=null;function d(){f!==null&&(f.lastChild.remove(),r.before(f),f=null);var v=s?i:l,h=s?l:i;v&&en(v),h&&Qt(h,()=>{s?l=null:i=null})}const c=(v,h)=>{if(s!==(s=v)){var _=jn(),y=r;if(_&&(f=document.createDocumentFragment(),f.append(y=Xt())),s?i??=h&&Je(()=>h(y)):l??=h&&Je(()=>h(y)),_){var g=A,p=s?i:l,w=s?l:i;p&&g.skipped_effects.delete(p),w&&g.skipped_effects.add(w),g.add_callback(d)}else d()}};Yn(()=>{o=!1,t(u),o||c(null,null)},a)}function xi(e,t){return t}function ki(e,t,n){for(var r=e.items,i=[],l=t.length,s=0;s<l;s++)Jt(t[s].e,i,!0);var a=l>0&&i.length===0&&n!==null;if(a){var o=n.parentNode;Qr(o),o.append(n),r.clear(),te(e,t[0].prev,t[l-1].next)}Jn(i,()=>{for(var u=0;u<l;u++){var f=t[u];a||(r.delete(f.k),te(e,f.prev,f.next)),fe(f.e,!a)}})}function Ei(e,t,n,r,i,l=null){var s=e,a={flags:t,items:new Map,first:null},o=null,u=!1,f=new Map,d=On(()=>{var _=n();return yt(_)?_:_==null?[]:Ut(_)}),c,v;function h(){Si(v,c,a,f,s,i,t,r,n),l!==null&&(c.length===0?o?en(o):o=Je(()=>l(s)):o!==null&&Qt(o,()=>{o=null}))}Yn(()=>{v??=k,c=T(d);var _=c.length;if(!(u&&_===0)){u=_===0;var y,g,p,w;if(jn()){var b=new Set,m=A;for(g=0;g<_;g+=1){p=c[g],w=r(p,g);var E=a.items.get(w)??f.get(w);E?sr(E,p,g):(y=or(null,a,null,null,p,w,g,i,t,n,!0),f.set(w,y)),b.add(w)}for(const[R,I]of a.items)b.has(R)||m.skipped_effects.add(I.e);m.add_callback(h)}else h();T(d)}})}function Si(e,t,n,r,i,l,s,a,o){var u=t.length,f=n.items,d=n.first,c=d,v,h=null,_=[],y=[],g,p,w,b;for(b=0;b<u;b+=1){if(g=t[b],p=a(g,b),w=f.get(p),w===void 0){var m=r.get(p);if(m!==void 0){r.delete(p),f.set(p,m);var E=h?h.next:c;te(n,h,m),te(n,m,E),Mt(m,E,i),h=m}else{var R=c?c.e.nodes_start:i;h=or(R,n,h,h===null?n.first:h.next,g,p,b,l,s,o)}f.set(p,h),_=[],y=[],c=h.next;continue}if(sr(w,g,b),(w.e.f&ee)!==0&&en(w.e),w!==c){if(v!==void 0&&v.has(w)){if(_.length<y.length){var I=y[0],$;h=I.prev;var B=_[0],V=_[_.length-1];for($=0;$<_.length;$+=1)Mt(_[$],I,i);for($=0;$<y.length;$+=1)v.delete(y[$]);te(n,B.prev,V.next),te(n,h,B),te(n,V,I),c=I,h=V,b-=1,_=[],y=[]}else v.delete(w),Mt(w,c,i),te(n,w.prev,w.next),te(n,w,h===null?n.first:h.next),te(n,h,w),h=w;continue}for(_=[],y=[];c!==null&&c.k!==p;)(c.e.f&ee)===0&&(v??=new Set).add(c),y.push(c),c=c.next;if(c===null)continue;w=c}_.push(w),h=w,c=w.next}if(c!==null||v!==void 0){for(var C=v===void 0?[]:Ut(v);c!==null;)(c.e.f&ee)===0&&C.push(c),c=c.next;var q=C.length;if(q>0){var oe=null;ki(n,C,oe)}}e.first=n.first&&n.first.e,e.last=h&&h.e;for(var X of r.values())fe(X.e);r.clear()}function sr(e,t,n,r){Qe(e.v,t),e.i=n}function or(e,t,n,r,i,l,s,a,o,u,f){var d=(o&$r)!==0,c=(o&Mr)===0,v=d?c?Pe(i,!1,!1):Ze(i):i,h=(o&Ar)===0?s:Ze(s),_={i:h,v,k:l,a:null,e:null,prev:n,next:r};try{if(e===null){var y=document.createDocumentFragment();y.append(e=Xt())}return _.e=Je(()=>a(e,v,h,u),Dr),_.e.prev=n&&n.e,_.e.next=r&&r.e,n===null?f||(t.first=_):(n.next=_,n.e.next=_.e),r!==null&&(r.prev=_,r.e.prev=_.e),_}finally{}}function Mt(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,i=t?t.e.nodes_start:n,l=e.e.nodes_start;l!==null&&l!==r;){var s=xt(l);i.before(l),l=s}}function te(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}const _n=[...` 	
\r\f \v\uFEFF`];function Pi(e,t,n){var r=e==null?"":""+e;if(t&&(r=r?r+" "+t:t),n){for(var i in n)if(n[i])r=r?r+" "+i:i;else if(r.length)for(var l=i.length,s=0;(s=r.indexOf(i,s))>=0;){var a=s+l;(s===0||_n.includes(r[s-1]))&&(a===r.length||_n.includes(r[a]))?r=(s===0?"":r.substring(0,s))+r.substring(a+1):s=a}}return r===""?null:r}function Ci(e,t){return e==null?null:String(e)}function ar(e,t,n,r,i,l){var s=e.__className;if(s!==n||s===void 0){var a=Pi(n,r,l);a==null?e.removeAttribute("class"):e.className=a,e.__className=n}else if(l&&i!==l)for(var o in l){var u=!!l[o];(i==null||u!==!!i[o])&&e.classList.toggle(o,u)}return l}function tn(e,t,n,r){var i=e.__style;if(i!==t){var l=Ci(t);l==null?e.removeAttribute("style"):e.style.cssText=l,e.__style=t}return r}function ur(e,t,n=!1){if(e.multiple){if(t==null)return;if(!yt(t))return Ir();for(var r of e.options)r.selected=t.includes(Ve(r));return}for(r of e.options){var i=Ve(r);if(Xr(i,t)){r.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function Ti(e){var t=new MutationObserver(()=>{ur(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Zt(()=>{t.disconnect()})}function $i(e,t,n=t){var r=!0;Bn(e,"change",i=>{var l=i?"[selected]":":checked",s;if(e.multiple)s=[].map.call(e.querySelectorAll(l),Ve);else{var a=e.querySelector(l)??e.querySelector("option:not([disabled])");s=a&&Ve(a)}n(s)}),Vn(()=>{var i=t();if(ur(e,i,r),r&&i===void 0){var l=e.querySelector(":checked");l!==null&&(i=Ve(l),n(i))}e.__value=i,r=!1}),Ti(e)}function Ve(e){return"__value"in e?e.__value:e.value}const Ai=Symbol("is custom element"),Mi=Symbol("is html");function ae(e,t,n,r){var i=Ri(e);i[t]!==(i[t]=n)&&(t==="loading"&&(e[yr]=n),n==null?e.removeAttribute(t):typeof n!="string"&&Oi(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function Ri(e){return e.__attributes??={[Ai]:e.nodeName.includes("-"),[Mi]:e.namespaceURI===Nr}}var gn=new Map;function Oi(e){var t=e.getAttribute("is")||e.nodeName,n=gn.get(t);if(n)return n;gn.set(t,n=[]);for(var r,i=e,l=Element.prototype;l!==i;){r=kn(i);for(var s in r)r[s].set&&n.push(s);i=Ht(i)}return n}function Fe(e,t,n=t){var r=new WeakSet;Bn(e,"input",async i=>{var l=i?e.defaultValue:e.value;if(l=Rt(e)?Ot(l):l,n(l),A!==null&&r.add(A),await ci(),l!==(l=t())){var s=e.selectionStart,a=e.selectionEnd;e.value=l??"",a!==null&&(e.selectionStart=s,e.selectionEnd=Math.min(a,e.value.length))}}),O(t)==null&&e.value&&(n(Rt(e)?Ot(e.value):e.value),A!==null&&r.add(A)),Gn(()=>{var i=t();if(e===document.activeElement){var l=st??A;if(r.has(l))return}Rt(e)&&i===Ot(e.value)||e.type==="date"&&!i&&!e.value||i!==e.value&&(e.value=i??"")})}function Rt(e){var t=e.type;return t==="number"||t==="range"}function Ot(e){return e===""?null:+e}function wn(e,t){return e===t||e?.[he]===t}function Pt(e={},t,n,r){return Vn(()=>{var i,l;return Gn(()=>{i=l,l=[],O(()=>{e!==n(...l)&&(t(e,...l),i&&wn(n(...i),e)&&t(null,...i))})}),()=>{Rn(()=>{l&&wn(n(...l),e)&&t(null,...l)})}}),e}function Ni(e){return function(...t){var n=t[0];return n.stopPropagation(),e?.apply(this,t)}}function Ii(e){return function(...t){var n=t[0];return n.preventDefault(),e?.apply(this,t)}}function $e(e=!1){const t=N,n=t.l.u;if(!n)return;let r=()=>vi(t.s);if(e){let i=0,l={};const s=Gt(()=>{let a=!1;const o=t.s;for(const u in o)o[u]!==l[u]&&(l[u]=o[u],a=!0);return a&&i++,i});r=()=>T(s)}n.b.length&&ti(()=>{yn(t,r),ut(n.b)}),Lt(()=>{const i=O(()=>n.m.map(_r));return()=>{for(const l of i)typeof l=="function"&&l()}}),n.a.length&&Lt(()=>{yn(t,r),ut(n.a)})}function yn(e,t){if(e.l.s)for(const n of e.l.s)T(n);t()}function fr(e,t,n){if(e==null)return t(void 0),Ne;const r=O(()=>e.subscribe(t,n));return r.unsubscribe?()=>r.unsubscribe():r}const Me=[];function Ct(e,t=Ne){let n=null;const r=new Set;function i(a){if(Tn(e,a)&&(e=a,n)){const o=!Me.length;for(const u of r)u[1](),Me.push(u,e);if(o){for(let u=0;u<Me.length;u+=2)Me[u][0](Me[u+1]);Me.length=0}}}function l(a){i(a(e))}function s(a,o=Ne){const u=[a,o];return r.add(u),r.size===1&&(n=t(i,l)||Ne),a(e),()=>{r.delete(u),r.size===0&&n&&(n(),n=null)}}return{set:i,update:l,subscribe:s}}function L(e){let t;return fr(e,n=>t=n)(),t}let Ft=Symbol();function le(e,t,n){const r=n[t]??={store:null,source:Pe(void 0),unsubscribe:Ne};if(r.store!==e&&!(Ft in n))if(r.unsubscribe(),r.store=e??null,e==null)r.source.v=void 0,r.unsubscribe=Ne;else{var i=!0;r.unsubscribe=fr(e,l=>{i?r.source.v=l:H(r.source,l)}),i=!1}return e&&Ft in n?L(e):T(r.source)}function se(){const e={};function t(){Zt(()=>{for(var n in e)e[n].unsubscribe();at(e,Ft,{enumerable:!1,value:!0})})}return[e,t]}function Ce(e,t,n){return e.set(n),t}function je(e){N===null&&Pn(),nt&&N.l!==null?Li(N).m.push(e):Lt(()=>{const t=O(e);if(typeof t=="function")return t})}function Di(e){N===null&&Pn(),je(()=>()=>O(e))}function Li(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}const qi="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(qi);qr();class Fi{constructor(t,n){this.x=t,this.y=n}}const _t={PEN:"PEN",ERASER:"ERASER",FILL:"FILL",PICKER:"PICKER",SHAPE:"SHAPE"},gt={CONTINUOUS:"CONTINUOUS",DOTTED:"DOTTED"};class it{constructor(t,n,r){this.width=t,this.height=n,this.scale=r,this.pixels=new Array(n);for(let i=0;i<n;i++)this.pixels[i]=new Array(t).fill(null)}setPixels(t,n){this.pixels=t,n&&this.redraw(n)}getPixels(){let t=new Array(this.height);for(let n=0;n<this.height;n++)t[n]=this.pixels[n].slice();return t}redraw(t){t.clearRect(0,0,this.width*this.scale,this.height*this.scale);for(let n=0;n<this.height;n++)for(let r=0;r<this.width;r++)console.log(`Pixel at (${r}, ${n}): ${this.pixels[n][r]}`),this.pixels[n][r]!==null&&(t.fillStyle=this.pixels[n][r],t.fillRect(r*this.scale,n*this.scale,this.scale,this.scale))}draw(t,n){t.y<0||t.y>=this.height||t.x<0||t.x>=this.width||(this.pixels[t.y][t.x]=n)}drawPoint(t,n,r){t.y<0||t.y>=this.height||t.x<0||t.x>=this.width||(this.pixels[t.y][t.x]=n,r&&n!==null?(r.fillStyle=n,r.fillRect(t.x*this.scale,t.y*this.scale,this.scale,this.scale)):r&&n===null&&r.clearRect(t.x*this.scale,t.y*this.scale,this.scale,this.scale))}getColor(t){return this.pixels[t.y][t.x]}drawPoints(t,n,r){for(let{x:i,y:l}of t)this.pixels[l][i]=n;if(r&&n!==null){r.fillStyle=n;for(let{x:i,y:l}of t)r.fillRect(i*this.scale,l*this.scale,this.scale,this.scale)}else if(r&&n===null)for(let{x:i,y:l}of t)r.clearRect(i*this.scale,l*this.scale,this.scale,this.scale)}copy(){let t=new it(this.width,this.height,this.scale);return t.pixels=this.getPixels(),t}}class mn{constructor(t,n,r){this.pictureStore=t,this.initialPicturePixels=n.getPixels(),this.finalPicturePixels=r.getPixels()}execute(){this.pictureStore.setPixels(this.finalPicturePixels,null)}undo(){this.pictureStore.setPixels(this.initialPicturePixels,null)}}class Ui{constructor(t,n,r){this.pictureStore=t,this.initialPicturePixels=n.getPixels(),this.finalPicturePixels=r.getPixels()}execute(){this.pictureStore.setPixels(this.finalPicturePixels,null)}undo(){this.pictureStore.setPixels(this.initialPicturePixels,null)}}const xe=10,Hi=900,zi=600,ji=1,Bi=1,Wi="CONTINUOUS";function Ki(){const e=Ct(new it(90,60,xe)),{subscribe:t,set:n,update:r}=e;return{subscribe:t,set:n,update:r,drawPoint(i,l,s){r(a=>(a.drawPoint(i,l,s),a))},drawPoints(i,l,s){r(a=>(a.drawPoints(i,l,s),a))},getColor(i){return L(e).getColor(i)},fillColor(i,l,s){r(a=>{const o=[{dx:-1,dy:0},{dx:1,dy:0},{dx:0,dy:-1},{dx:0,dy:1}];let u=a.getColor(i),f=[i];for(let d=0;d<f.length;d++)for(let{dx:c,dy:v}of o){let h=f[d].x+c,_=f[d].y+v;h>=0&&h<a.width&&_>=0&&_<a.height&&a.getColor({x:h,y:_})==u&&!f.some(y=>y.x==h&&y.y==_)&&f.push({x:h,y:_})}return a.drawPoints(f,l,s),a})},getPixels(){return L(e).getPixels()},setPixels(i,l){r(s=>(s.setPixels(i,l),s))}}}function Vi(e){const{subscribe:t,set:n,update:r}=Ct({undoStack:[],redoStack:[]});return{subscribe:t,execute:i=>{i.execute(),r(l=>(console.log("Executing command:",i),e.update(s=>s),{undoStack:[...l.undoStack,i],redoStack:[]}))},undo:()=>{r(i=>{const l=i.undoStack.pop();return l?(l.undo(),e.update(s=>s),{...i,redoStack:[...i.redoStack,l]}):i})},redo:()=>{r(i=>{const l=i.redoStack.pop();return l?(l.execute(),e.update(s=>s),{...i,undoStack:[...i.undoStack,l]}):i})}}}const wt=Ki(),Gi=Vi(wt),lt=Ct({color:"#000000",background_color:"#E1E3EA",tool:"PEN",strokeColor:null,strokeWidth:ji,eraserSize:Bi,strokeShape:Wi,showGrid:!1}),cr=Ct("rect"),W={config:lt,selectedShape:cr,pictureStore:wt,commandHistory:Gi},Yi="#E1E4EA",bn=xe,Ge=Hi,Ye=zi;function Re(e,t){let n=t.getBoundingClientRect(),r=Math.floor((e.clientX-n.left)/xe),i=Math.floor((e.clientY-n.top)/xe);return r=Math.max(0,Math.min(r,t.width/xe)),i=Math.max(0,Math.min(i,t.height/xe)),{x:r,y:i}}function Xi(e){return e.classList[0]}function Zi(e,t,n,r,i,l,s,a){const u=L(lt).strokeShape;let f=Math.min(e.x,t.x),d=Math.min(e.y,t.y),c=Math.max(e.x,t.x),v=Math.max(e.y,t.y);if(a){let y=c-f,g=v-d,p=Math.max(y,g);t.x<e.x?f=e.x-p:c=f+p,t.y<e.y?d=e.y-p:v=d+p}let h=[],_=[];for(let y=d;y<v;y++)for(let g=f;g<c;g++)g>=f&&g<c&&y>=d&&y<v&&(g<f+i||g>=c-i||y<d+i||y>=v-i?_.push({x:g,y}):h.push({x:g,y}));if(s.drawPoints(h,n,l),u===gt.DOTTED){const y=dr(_);s.drawPoints(y,r,l)}else s.drawPoints(_,r,l)}function Qi(e,t,n,r,i,l,s,a){const u=L(lt).strokeShape;let f=Math.abs(t.x-e.x),d=Math.abs(t.y-e.y);if(a){let p=Math.max(f,d);f=p,d=p}let c=[],v=[],h=e.x-f,_=e.y-d,y=e.x+f,g=e.y+d;for(let p=_;p<=g;p++)for(let w=h;w<=y;w++)if(Math.pow(w-e.x,2)/Math.pow(f,2)+Math.pow(p-e.y,2)/Math.pow(d,2)<=1&&w>=0&&w<s.width&&p>=0&&p<s.height){let b=!1;f>i&&d>i?Math.pow(w-e.x,2)/Math.pow(f-i,2)+Math.pow(p-e.y,2)/Math.pow(d-i,2)>1&&(b=!0):b=!0,b?v.push({x:w,y:p}):c.push({x:w,y:p})}if(s.drawPoints(c,n,l),u===gt.DOTTED){v.sort((w,b)=>{const m=Math.atan2(w.y-e.y,w.x-e.x),E=Math.atan2(b.y-e.y,b.x-e.x);return m-E});const p=tl(v);s.drawPoints(p,r,l)}else s.drawPoints(v,r,l)}function Ji(e,t,n,r,i){let l=e.x,s=e.y,a=t.x,o=t.y,u=[],f=Math.abs(a-l),d=Math.abs(o-s),c=l<a?1:-1,v=s<o?1:-1,h=f-d;const y=L(lt).strokeShape;for(;y===gt.CONTINUOUS&&u.push({x:l,y:s}),!(l===a&&s===o);){let g=2*h;g>-d&&(h-=d,l+=c),g<f&&(h+=f,s+=v)}if(y===gt.DOTTED){const g=dr(u);i.drawPoints(g,n,r)}else i.drawPoints(u,n,r)}function el(e,t,n,r,i,l,s,a){const o=L(cr);o==="rect"?Zi(e,t,n,r,i,l,s,a):o==="circle"?Qi(e,t,n,r,i,l,s,a):(console.log("Drawing line with:",{start:e,end:t,color:n,strokeColor:r,strokeWidth:i}),Ji(e,t,n,l,s))}function dr(e){return e.filter(t=>(t.x+t.y)%2===0)}function tl(e){const t=[];for(let n=0;n<e.length;n+=2)t.push(e[n]);return t}var nl=j('<canvas id="canvas" style="position: absolute; top: 0; left: 0; z-index: 2;"></canvas>');function rl(e,t){ye(t,!1);const n=()=>le(s,"$pictureStore",r),[r,i]=se(),{config:l,pictureStore:s,commandHistory:a}=W;let o=Pe(),u,f,d,c=!1,v=!0;s.subscribe(m=>{v=!0}),je(()=>{u=T(o).getContext("2d");function m(){requestAnimationFrame(m),v&&(v=!1,n().redraw(u))}m()});function h(m,E){let R=E.color;if(E.tool===_t.ERASER&&(R=null),E.tool===_t.ERASER){let I=E.eraserSize??1,$=Math.floor(I/2);for(let B=0;B<I;B++)for(let V=0;V<I;V++){let C=m.x-$+B,q=m.y-$+V;n().draw(new Fi(C,q),R)}}else n().draw(m,R);v=!0}function _(m){let E=s.getColor(m);l.update(R=>({...R,color:E??R.color}))}function y(m){if(m.button==0)switch(c=!0,f=Re(m,u.canvas),d=n().copy(),L(l).tool){case"PICKER":_(Re(m,u.canvas));return;case"FILL":s.fillColor(Re(m,u.canvas),L(l).color,u);let E=new Ui(s,d,n());a.execute(E);break;default:h(Re(m,u.canvas),L(l))}}function g(m){c&&(s.set(d),c=!1,v=!0)}function p(m){if(c)switch(L(l).tool){case"SHAPE":let E=Re(m,u.canvas),R=d.copy();el(f,E,L(l).color,L(l).strokeColor,L(l).strokeWidth,u,R,m.shiftKey),s.set(R),v=!0;break;case"PICKER":break;default:h(Re(m,u.canvas),L(l))}}function w(m){if(c)if(c=!1,L(l).tool==="SHAPE"){let E=new mn(s,d,n());a.execute(E),d=null}else{let E=new mn(s,d,n());a.execute(E),d=null}}$e();var b=nl();Pt(b,m=>H(o,m),()=>T(o)),_e(()=>{ae(b,"width",Ge),ae(b,"height",Ye)}),S("mousedown",b,y),S("mousemove",b,p),S("mouseup",b,w),S("contextmenu",b,Ii(Ni(g))),z(e,b),me(),i()}var il=j('<canvas style="position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;"></canvas>');function ll(e,t){ye(t,!1);let n=Pe(),r;je(()=>{r=T(n).getContext("2d"),i()});function i(){r.strokeStyle="#ccc",r.lineWidth=1;for(let s=0;s<Ge;s+=bn)r.beginPath(),r.moveTo(s,0),r.lineTo(s,Ye),r.stroke();for(let s=0;s<Ye;s+=bn)r.beginPath(),r.moveTo(0,s),r.lineTo(Ge,s),r.stroke()}$e();var l=il();Pt(l,s=>H(n,s),()=>T(n)),_e(()=>{ae(l,"width",Ge),ae(l,"height",Ye)}),z(e,l),me()}var sl=j("<div><!> <!></div>");function ol(e){const t=()=>le(i,"$config",n),[n,r]=se(),{config:i}=W;var l=sl(),s=M(l);rl(s,{});var a=P(s,2);{var o=u=>{ll(u,{})};pt(a,u=>{t().showGrid&&u(o)})}_e(()=>tn(l,`position: relative; width: ${Ge}px; height: ${Ye}px; border:1px solid #000; background-color: ${Yi}`)),z(e,l),r()}function al(e){ol(e)}var ul=j('<div class="context-menu svelte-1gyc2lk"><button class="shape img svelte-1gyc2lk">Rectangle</button> <button class="shape img svelte-1gyc2lk">Circle</button> <button class="shape img svelte-1gyc2lk">Line</button></div>'),fl=j('<div data-tooltip="shape" role="button" tabindex="0"><img alt="Shape Tool" width="42px" class="shape img svelte-1gyc2lk"/> <!></div>');function cl(e,t){ye(t,!1);const n=()=>le(l,"$selectedShape",r),[r,i]=se(),{selectedShape:l,config:s}=W;let a=Pe(!1),o=Pe();je(()=>{window.addEventListener("click",u)}),Di(()=>{window.removeEventListener("click",u)});function u(g){T(o)&&!T(o).contains(g.target)&&H(a,!1)}function f(g){g.preventDefault(),H(a,!0)}function d(g){l.set(g),s.update(p=>({...p,tool:_t.SHAPE})),H(a,!1)}$e();var c=fl();let v;var h=M(c),_=P(h,2);{var y=g=>{var p=ul(),w=M(p),b=P(w,2),m=P(b,2);S("click",w,()=>d("rect")),S("click",b,()=>d("circle")),S("click",m,()=>d("line")),z(g,p)};pt(_,g=>{T(a)&&g(y)})}Pt(c,g=>H(o,g),()=>T(o)),_e(g=>{v=ar(c,1,"tool svelte-1gyc2lk",null,v,g),ae(h,"src",n()==="rect"?"./icons//rect.png":n()==="circle"?"./icons//circle.png":"./icons//line.png")},[()=>({"menu-open":T(a)})]),S("contextmenu",c,f),S("keydown",c,g=>g.key==="Enter"&&f(g)),z(e,c),me(),i()}class dl{constructor(t){this.pic=t,this.originalPicture=t.copy(),this.newPicture=new it(t.width,t.height,t.scale)}execute(){wt.update(t=>this.newPicture)}undo(){wt.update(t=>this.originalPicture)}}var vl=j('<div class="tool svelte-hdq7w9"><button class="svelte-hdq7w9"><img width="42px"/></button></div>'),hl=j('<main class="svelte-hdq7w9"><!> <div role="button" tabindex="0"><!></div> <div class="undo svelte-hdq7w9" data-tooltip="undo"><button aria-label="Undo" class="svelte-hdq7w9"><img src="./icons//undo.png" class="undo svelte-hdq7w9" width="40" alt="undo icon"/></button></div> <div class="redo svelte-hdq7w9" data-tooltip="redo"><button aria-label="Redo" class="svelte-hdq7w9"><img src="./icons//redo.png" class="redo svelte-hdq7w9" width="40" alt="redo icon"/></button></div> <div class="color-picker svelte-hdq7w9" data-tooltip="color picker" role="button" tabindex="0"></div> <input type="color" id="colorInput" style="display: none;"/> <div class="non-color-option svelte-hdq7w9" data-tooltip="no color" role="button" tabindex="0"></div></main>');function pl(e,t){ye(t,!1);const n=()=>le(l,"$config",r),[r,i]=se(),{config:l,commandHistory:s,pictureStore:a}=W,o=["pen","eraser","fill","picker"];let u,f,d,c;je(()=>{u=Array.from(document.querySelectorAll(".img")),c=document.querySelector(".shape.img"),c&&u.push(c),f=document.querySelector("canvas"),d=f.getContext("2d");const C=u.find(q=>q.classList.contains("pen"));C&&(C.style.borderWidth="1px")});function v(){s.undo(),a.update(C=>(C.redraw(d),C))}function h(){s.redo(),a.update(C=>(C.redraw(d),C))}function _(C){let q=Xi(C.target),oe;u.map(X=>{X.style.borderWidth="0px"}),u.forEach(X=>{X.classList[0]==q&&(oe=X)}),oe&&(oe.style.borderWidth="1px",l.update(X=>({...X,tool:_t[q.toUpperCase()]})))}function y(){c&&_({target:c})}$e();var g=hl(),p=M(g);Ei(p,1,()=>o,xi,(C,q)=>{var oe=vl(),X=M(oe),Tt=M(X);_e(()=>{ae(oe,"data-tooltip",T(q)),ae(X,"aria-label",T(q)),ae(Tt,"src",`./icons//${T(q)??""}.png`),ar(Tt,1,`${T(q)??""} img`,"svelte-hdq7w9"),ae(Tt,"alt",T(q))}),S("click",X,_),z(C,oe)});var w=P(p,2),b=M(w);cl(b,{});var m=P(w,2),E=M(m),R=P(m,2),I=M(R),$=P(R,2),B=P($,2),V=P(B,2);_e(()=>tn($,`background-color: ${n().color??""}`)),S("click",w,y),S("keydown",w,C=>C.key==="Enter"&&y()),S("click",E,v),S("click",I,h),S("click",$,()=>document.getElementById("colorInput").click()),S("keydown",$,C=>C.key==="Enter"&&document.getElementById("colorInput").click()),Fe(B,()=>n().color,C=>Ce(l,O(n).color=C,O(n))),S("click",V,()=>l.update(C=>({...C,color:null}))),S("keydown",V,C=>C.key==="Enter"&&l.update(q=>({...q,color:null}))),z(e,g),me(),i()}var _l=j('<div class="action-button svelte-qgl38r" data-tooltip="show grid"><button aria-label="Toggle grid" class="svelte-qgl38r"><img src="./icons/grid.png" alt="Toggle grid" width="30px" class="svelte-qgl38r"/></button></div> <div class="action-button svelte-qgl38r" data-tooltip="Clear all"><button aria-label="Clear all" class="svelte-qgl38r"><img src="/icons/clean-all.png" alt="Clean all" width="30px" class="svelte-qgl38r"/></button></div> <div class="action-button svelte-qgl38r" data-tooltip="Save"><button aria-label="Save" class="svelte-qgl38r"><img src="/icons/download.png" alt="Save" width="30px" class="svelte-qgl38r"/></button></div> <div class="action-button svelte-qgl38r" data-tooltip="Load"><button aria-label="Load" class="svelte-qgl38r"><img src="/icons/ulpoad.png" alt="Load" width="30px" class="svelte-qgl38r"/></button></div> <input type="file" style="display: none;"/>',1);function gl(e,t){ye(t,!1);let n=Pe();function r(){W.config.update(p=>({...p,showGrid:!p.showGrid}))}function i(){const p=document.querySelector("#canvas");if(p){const w=document.createElement("a");w.download="drawing.png",w.href=p.toDataURL("image/png"),w.click()}}function l(){T(n).click()}function s(p){const w=p.target;if(!w.files)return;const b=w.files[0];if(!b)return;const m=new FileReader;m.onload=()=>{const E=new Image;E.onload=async()=>{const R=document.querySelector("#canvas");if(!R)return;const I=R.getContext("2d");if(!I)return;const $=await a(E),B=new it($.length,$[0].length,xe);B.setPixels($,I),W.pictureStore.update(V=>B),W.pictureStore.subscribe(V=>V.redraw(I))()},E.src=m.result},m.readAsDataURL(b)}async function a(p){const w=Math.min(90,p.width),b=Math.min(60,p.height),E=new OffscreenCanvas(w,b).getContext("2d");if(!E)return[];E.drawImage(p,0,0,w,b);const R=E.getImageData(0,0,w,b);return new Promise(I=>{const $=new Worker(new URL("/assets/imageProcessor.worker-DaQdNDH-.js",import.meta.url));$.onmessage=B=>{I(B.data),$.terminate()},$.postMessage({imageData:R})})}$e();var o=_l(),u=kt(o),f=M(u),d=P(u,2),c=M(d),v=P(d,2),h=M(v),_=P(v,2),y=M(_),g=P(_,2);Pt(g,p=>H(n,p),()=>T(n)),S("click",f,r),S("click",c,()=>{const p=L(W.pictureStore),w=new dl(p);W.commandHistory.execute(w),w.execute()}),S("click",h,i),S("click",y,l),S("change",g,s),z(e,o),me()}var wl=j('<div class="stroke-width-slider svelte-1tf0fc2" data-tooltip="stroke width"><img src="./icons//stroke.png" width="90" style="margin-bottom: 10px;" alt="Stroke width"/> <input type="range" min="0" max="3" style="width: 80px;" class="svelte-1tf0fc2"/> <input type="number" min="1" max="3" class="stroke-width-input svelte-1tf0fc2" readonly=""/></div>');function yl(e){const t=()=>le(i,"$config",n),[n,r]=se(),{config:i}=W;function l(u){i.update(f=>({...f,strokeWidth:Number(u.target.value)}))}var s=wl(),a=P(M(s),2),o=P(a,2);Fe(a,()=>t().strokeWidth,u=>Ce(i,O(t).strokeWidth=u,O(t))),S("input",a,l),Fe(o,()=>t().strokeWidth,u=>Ce(i,O(t).strokeWidth=u,O(t))),z(e,s),r()}var ml=j('<img src="./icons//style-prop.png" width="80" style="margin-bottom: 7px;" alt="Stroke shape"/> <div class="stroke-shape-selector svelte-yvza1x" data-tooltip="stroke shape"><select class="svelte-yvza1x"><option>Continuous</option><option>Dotted</option></select></div>',1);function bl(e){const t=()=>le(i,"$config",n),[n,r]=se(),{config:i}=W;function l(d){i.update(c=>({...c,strokeShape:d.target.value}))}var s=ml(),a=P(kt(s),2),o=M(a);_e(()=>{t(),oi(()=>{})});var u=M(o);u.value=u.__value="CONTINUOUS";var f=P(u);f.value=f.__value="DOTTED",S("change",o,l),$i(o,()=>t().strokeShape,d=>Ce(i,O(t).strokeShape=d,O(t))),z(e,s),r()}var xl=j('<img src="./icons//color-prop.png" width="80" style="margin-bottom: 7px;" alt="Stroke shape"/> <div class="stroke-color-picker svelte-6vnwhu" data-tooltip="stroke color picker" role="button" tabindex="0"></div> <input type="color" id="strokeColorInput" style="display: none;"/> <div class="non-color-option svelte-6vnwhu" data-tooltip="no stroke color" role="button" tabindex="0"></div>',1);function kl(e,t){ye(t,!1);const n=()=>le(l,"$config",r),[r,i]=se(),{config:l}=W;function s(d){l.update(c=>({...c,strokeColor:d.target.value}))}$e();var a=xl(),o=P(kt(a),2),u=P(o,2),f=P(u,2);_e(()=>tn(o,`background-color: ${n().strokeColor??""}`)),S("click",o,()=>document.getElementById("strokeColorInput").click()),S("keydown",o,d=>d.key==="Enter"&&document.getElementById("strokeColorInput").click()),Fe(u,()=>n().strokeColor,d=>Ce(l,O(n).strokeColor=d,O(n))),S("input",u,s),S("click",f,()=>l.update(d=>({...d,strokeColor:null}))),S("keydown",f,d=>d.key==="Enter"&&l.update(c=>({...c,strokeColor:null}))),z(e,a),me(),i()}var El=j('<div class="stroke-width-slider svelte-1szuzkk" data-tooltip="eraser size"><img src="./icons//eraser-prop.png" width="90" style="margin-bottom: 10px;" alt="Eraser size"/> <input type="range" min="1" max="3" style="width: 80px;" class="svelte-1szuzkk"/> <input type="number" min="1" max="3" class="stroke-width-input svelte-1szuzkk" readonly=""/></div>');function Sl(e){const t=()=>le(i,"$config",n),[n,r]=se(),{config:i}=W;var l=El(),s=P(M(l),2),a=P(s,2);Fe(s,()=>t().eraserSize,o=>Ce(i,O(t).eraserSize=o,O(t))),Fe(a,()=>t().eraserSize,o=>Ce(i,O(t).eraserSize=o,O(t))),z(e,l),r()}var Pl=j("<!> <!> <!>",1),Cl=j('<div class="prop-panel svelte-15aswwh"><!> <!></div>');function Tl(e){const t=()=>le(i,"$config",n),[n,r]=se(),{config:i}=W;var l=Cl(),s=M(l);{var a=f=>{var d=Pl(),c=kt(d);yl(c);var v=P(c,2);bl(v);var h=P(v,2);kl(h,{}),z(f,d)};pt(s,f=>{t().tool==="SHAPE"&&f(a)})}var o=P(s,2);{var u=f=>{Sl(f)};pt(o,f=>{t().tool==="ERASER"&&f(u)})}z(e,l),r()}var $l=j('<main class="svelte-1gfk0lm"><!> <div class="main-panel svelte-1gfk0lm"><div class="toolbox svelte-1gfk0lm"><!></div> <div class="canvas svelte-1gfk0lm"><!></div> <div class="action-buttons svelte-1gfk0lm"><!></div></div></main>');function Al(e,t){ye(t,!1);const n=()=>le(lt,"$config",r),[r,i]=se();je(()=>{console.log("Current tool:",n().tool)}),$e();var l=$l(),s=M(l);Tl(s);var a=P(s,2),o=M(a),u=M(o);pl(u,{});var f=P(o,2),d=M(f);al(d);var c=P(f,2),v=M(c);gl(v,{}),z(e,l),me(),i()}yi(Al,{target:document.getElementById("app")});
